# models/staging/patient_info/_patient_info__models.yml

version: 2

models:
  - name: stg_patient_info
    description: "Cleans and standardizes raw patient information. Contains multiple versions."
    latest_version: 3 # This declares that v1 is the current "production" version

    versions:
      - v: 1
        # dbt is smart enough to find stg_patient_info_v1.sql based on convention,
        columns:
          - name: patient_id
            tests: [unique, not_null]
          - name: sex
            tests:
              - accepted_values:
                  values: ['male', 'female']
      - v: 2
      # dbt is smart enough to find stg_patient_info_v2.sql based on convention,
        columns:
          - name: patient_id
          - name: biological_sex # The new column name in v2
      - v: 3
      # dbt is smart enough to find stg_patient_info_v3.sql based on convention
        columns:
          - name: patient_id
            tests: [not_null]
          - name: biological_sex
            tests:
              - accepted_values:
                  values: ['male', 'female']


